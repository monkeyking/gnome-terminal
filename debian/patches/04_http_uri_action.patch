===================================================================
RCS file: /cvs/gnome/gnome-terminal/src/terminal-screen.c,v
retrieving revision 1.121
retrieving revision 1.122
diff -u -r1.121 -r1.122
--- terminal-screen.c	2006/01/28 03:50:35	1.121
+++ src/terminal-screen.c	2006/02/02 18:32:11	1.122
@@ -1580,37 +1580,35 @@
 
   if (screen->priv->matched_string != NULL) 
     {
-      if (screen->priv->matched_flavor == FLAVOR_EMAIL)
+      if (screen->priv->matched_flavor == FLAVOR_EMAIL &&
+	  strncmp ("mailto:", screen->priv->matched_string, 7))
 	{
-	  if (strncmp ("mailto:", screen->priv->matched_string, 7))
-	    {
-	      menu_item = append_menuitem (screen->priv->popup_menu,
-					   _("_Send Mail To..."),
-					   G_CALLBACK (open_url_callback),
-					   screen);
-
-	      menu_item = append_menuitem (screen->priv->popup_menu,
-					   _("_Copy E-mail Address"),
-					   G_CALLBACK (copy_url_callback),
-					   screen);
-	    }
-	  else
-	    {
-	      menu_item = append_menuitem (screen->priv->popup_menu,
-					   _("_Open Link"),
-					   G_CALLBACK (open_url_callback),
-					   screen);
-
-	      menu_item = append_menuitem (screen->priv->popup_menu,
-					   _("_Copy Link Address"),
-					   G_CALLBACK (copy_url_callback),
-					   screen);
-	    }
+	  menu_item = append_menuitem (screen->priv->popup_menu,
+				       _("_Send Mail To..."),
+				       G_CALLBACK (open_url_callback),
+				       screen);
+
+	  menu_item = append_menuitem (screen->priv->popup_menu,
+				       _("_Copy E-mail Address"),
+				       G_CALLBACK (copy_url_callback),
+				       screen);
+	}
+      else
+	{
+	  menu_item = append_menuitem (screen->priv->popup_menu,
+				       _("_Open Link"),
+				       G_CALLBACK (open_url_callback),
+				       screen);
+
+	  menu_item = append_menuitem (screen->priv->popup_menu,
+				       _("_Copy Link Address"),
+				       G_CALLBACK (copy_url_callback),
+				       screen);
 	}
-
       menu_item = gtk_separator_menu_item_new ();
       gtk_widget_show (menu_item);
-      gtk_menu_shell_append (GTK_MENU_SHELL (screen->priv->popup_menu), menu_item);
+      gtk_menu_shell_append (GTK_MENU_SHELL (screen->priv->popup_menu),
+			     menu_item);
     }
 
   menu_item = append_menuitem (screen->priv->popup_menu,
@@ -2075,7 +2073,6 @@
                      TerminalScreen *screen)
 {
   char *text;
-  gboolean userset;
 
   text = gtk_editable_get_chars (GTK_EDITABLE (entry), 0, -1);
 
